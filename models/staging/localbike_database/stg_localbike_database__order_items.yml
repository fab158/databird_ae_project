models:
  - name: stg_localbike_database__order_items
    description: > 
        Table de staging des lignes de commandes permettant de formatter/normaliser 
        les données issues du systeme transactionnel de localbike
    data_tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_id
            - item_id
    
    columns:
      - name: order_id
        description: Identifiant de la commande
        data_tests:
          - relationships:
              arguments:
                to: ref('stg_localbike_database__orders')
                field: order_id 
      
      - name: product_id
        description: Identifiant du produit commandé
        data_tests:
          - relationships:
              arguments:
                to: ref('stg_localbike_database__products')
                field: product_id

      - name: list_price
        description: "Prix unitaire"
        tests:
          - not_null

      - name: quantity
        description: Quantite commandée
        data_tests:
         - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                inclusive: false

      - name: discount
        description: Taux de remise appliqué sur cette ligne de commande
        data_tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 1
   